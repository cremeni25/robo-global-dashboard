<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Robô Global de Afiliados - Painel PRO</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      margin: 0;
      background: #0e1117;
      color: #e6e6e6;
    }

    .layout {
      display: flex;
      height: 100vh;
    }

    /* MENU LATERAL */
    .sidebar {
      width: 260px;
      background: #161b22;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    .sidebar h2 {
      margin: 0 0 30px 0;
      font-size: 18px;
      color: #58a6ff;
    }

    .menu a {
      color: #c9d1d9;
      text-decoration: none;
      padding: 12px 10px;
      border-radius: 6px;
      margin-bottom: 6px;
      display: block;
    }

    .menu a.active,
    .menu a:hover {
      background: #21262d;
      color: #ffffff;
    }

    /* CONTEÚDO */
    .content {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
    }

    .content h1 {
      margin-top: 0;
      font-size: 24px;
    }

    /* CARD DE AÇÃO */
    .acao-card {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      max-width: 700px;
    }

    .acao-card h3 {
      margin-top: 0;
      color: #58a6ff;
    }

    .meta {
      margin: 8px 0;
      font-size: 14px;
    }

    .meta span {
      font-weight: bold;
    }

    .confirmar-btn {
      margin-top: 20px;
      background: #238636;
      border: none;
      color: #ffffff;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    .confirmar-btn:hover {
      background: #2ea043;
    }

    .status {
      margin-top: 15px;
      color: #7ee787;
      font-size: 14px;
      display: none;
    }

    @media (max-width: 900px) {
      .sidebar {
        width: 200px;
      }
    }
  </style>
</head>

<body>
  <div class="layout">
    <aside class="sidebar">
      <h2>Robo Global AI</h2>
      <nav class="menu">
        <a href="#" class="active">Ações Pendentes</a>
        <a href="#">Painel Principal</a>
        <a href="#">Decisor Mestre</a>
        <a href="#">Financeiro</a>
        <a href="#">Autonomia</a>
        <a href="#">Auditoria</a>
      </nav>
    </aside>

    <main class="content">
      <h1>Ações Pendentes</h1>

      <div class="acao-card" id="acao-1">
        <h3>Escalar campanha Hotmart</h3>
        <div class="meta"><span>Risco:</span> Médio</div>
        <div class="meta"><span>Motivo:</span> ROI positivo em 3 ciclos consecutivos</div>
        <div class="meta"><span>Impacto estimado:</span> +R$ 2.400 / mês</div>

        <button class="confirmar-btn" onclick="confirmarAcao()">CONFIRMAR</button>
        <div class="status" id="status">✔ Ação registrada. O robô retomará o ciclo.</div>
      </div>
    </main>
  </div>

<script>
  const API_BASE = "https://robo-global-api-v2.onrender.com";

  async function carregarAcoesPendentes() {
    try {
      const res = await fetch(`${API_BASE}/acoes-pendentes`);
      const acoes = await res.json();

      const container = document.querySelector(".content");
      container.innerHTML = "<h1>Ações Pendentes</h1>";

      if (!acoes || acoes.length === 0) {
        container.innerHTML += "<p>Nenhuma ação pendente no momento.</p>";
        return;
      }

      acoes.forEach(acao => {
        const card = document.createElement("div");
        card.className = "acao-card";

card.innerHTML = `
  <h3>${acao.descricao}</h3>
  <div class="meta"><span>Risco:</span> ${acao.risco}</div>
  <div class="meta"><span>Motivo:</span> ${acao.motivo}</div>
  <div class="meta"><span>Impacto:</span> ${acao.impacto || "-"}</div>
  <button class="confirmar-btn" onclick="confirmarAcao('${acao.id}', '${acao.url_destino || ""}')">
    CONFIRMAR
  </button>
`;

        container.appendChild(card);
      });
    } catch (e) {
      console.error("Erro ao carregar ações pendentes", e);
    }
  }

  async function confirmarAcao(id, url) {
    await fetch(`${API_BASE}/acoes-pendentes/${id}/confirmar`, { method: "POST" });
    if (url) window.open(url, "_blank");
    carregarAcoesPendentes();
  }

  carregarAcoesPendentes();
</script>

