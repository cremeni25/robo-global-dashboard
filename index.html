<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<title>Robo Global AI — Dashboard</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<style>
body{margin:0;font-family:Arial;background:#0e1117;color:#fff}
header{padding:14px 16px;background:#161b22;font-weight:bold}
nav{display:flex;gap:8px;padding:10px 16px;background:#0b0f14}
nav button{padding:8px 12px;border:0;border-radius:6px;background:#1f2933;color:#fff}
nav button.active{background:#2563eb}
.container{padding:16px}
.card{background:#161b22;border-radius:8px;padding:16px;margin-bottom:16px}
.kpi{font-size:18px;font-weight:bold;margin-bottom:6px}
.ok{color:#22c55e}
.critico{color:#ff4d4f}
</style>
</head>

<body>
<header>Robo Global AI — Snapshot Operacional</header>

<nav>
<button id="btn-snapshot" onclick="show('snapshot')">Snapshot</button>
<button id="btn-metricas" onclick="show('metricas')">Métricas</button>
<button id="btn-health" onclick="show('health')">Health</button>
<button id="btn-confirmacoes" onclick="show('confirmacoes')">Confirmações</button>
<button id="btn-sla" onclick="show('sla')">Alertas SLA</button>
<button id="btn-historico" onclick="show('historico')">Histórico</button>
</nav>

<div class="container">
<div id="view-snapshot" class="card"></div>
<div id="view-metricas" class="card" style="display:none"></div>
<div id="view-health" class="card" style="display:none"></div>
<div id="view-confirmacoes" class="card" style="display:none"></div>
<div id="view-sla" class="card" style="display:none"></div>
<div id="view-historico" class="card" style="display:none"></div>
</div>

<script>
const API="https://robo-global-api-v2.onrender.com";

function setActive(id){
["snapshot","metricas","health","confirmacoes","sla","historico"].forEach(v=>{
document.getElementById("btn-"+v).classList.remove("active");
document.getElementById("view-"+v).style.display="none";
});
document.getElementById("btn-"+id).classList.add("active");
document.getElementById("view-"+id).style.display="block";
}

function show(id){setActive(id)}

async function loadSnapshot(){
const e=document.getElementById("view-snapshot");
const r=await fetch(`${API}/snapshot`);
const d=await r.json();
e.innerHTML=`
<div class="kpi">Health: <span class="${d.health.api==='OK'?'ok':'critico'}">${d.health.api}</span></div>
<div>Decisões: ${d.metricas.decisoes_total}</div>
<div>Ciclos: ${d.metricas.ciclos_executados}</div>
<div>Alertas SLA: ${d.metricas.alertas_sla}</div>
<div>Confirmações pendentes: ${d.confirmacoes_pendentes}</div>
<div>Eventos históricos: ${d.historico_total}</div>
`;
}

async function refresh(){
loadSnapshot();
}

setActive("snapshot");
refresh();
setInterval(refresh,5000);
</script>
</body>
</html>
